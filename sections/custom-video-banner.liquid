{% assign sid = section.id %}

<style>
  #shopify-section-{{ sid }} {
    position: relative;
    width: 100%;
    height: calc(100dvh - 9.9rem);
  }

  #shopify-section-{{ sid }} video {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  #shopify-section-{{ sid }} .video-container {
    display: block;
    overflow: hidden;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  #shopify-section-{{ sid }} .video-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(26,26,26, 0.60); /* Black with 50% opacity */
    z-index: 1;
    pointer-events: none; /* So it doesnâ€™t block clicks */
    display: block;
  }

  #shopify-section-{{ sid }} .content {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    display: grid;
    gap: 2.4rem;
    justify-items: center;
    z-index: 2;
    text-align: center;
  }

  #shopify-section-{{ sid }} .content h1 {
    letter-spacing: -0.035em;
    font-size: 4.8rem;
    line-height: 1.15;
    color: #ffffff !important;
    white-space: nowrap;
  }

  @media screen and (min-width: 990px) {
    #shopify-section-{{ sid }} .content h1 {
      font-size: 6.4rem;
      letter-spacing: -0.04em
      line-height: 1.1;
    }
  }
</style>

<div class="video-container">
  <div class="video-overlay"></div>
  {% if section.settings.video != blank %}
    {{ section.settings.video | video_tag: autoplay: true, loop: true, controls: false, muted: true }}
  {% endif %}

  <div class="page-width">
    <div class="content">
      {% if section.settings.heading %}
        <h1
          class="{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {% if settings.animations_reveal_on_scroll %}
            data-cascade
            style="--animation-order: 1;"
          {% endif %}
        >
          {{ section.settings.heading }}
        </h1>
      {% endif %}

      {% if section.settings.button_label and section.settings.url_link %}
        <a
          class="button button--primary {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          href="{{ section.settings.url_link }}"
          {% if settings.animations_reveal_on_scroll %}
            data-cascade
            style="--animation-order: 2;"
          {% endif %}
        >
          {{- section.settings.button_label -}}
        </a>
      {% endif %}
    </div>
  </div>
</div>

<script>
  function setDynamicSwiperHeight() {
    const announcementBar = document.querySelector('.announcement-bar-section');
    const header = document.querySelector('.header-wrapper');

    const announcementHeight = announcementBar?.offsetHeight || 0;
    const headerHeight = header?.offsetHeight || 0;
    const windowHeight = window.innerHeight;

    const availableHeight = windowHeight - (announcementHeight + headerHeight);
    const heroSection = document.querySelector('.video__section');
    heroSection.style.height = `${availableHeight}px`;
  }

  // Run on load and resize
  window.addEventListener('load', setDynamicSwiperHeight);
</script>

{% schema %}
{
  "name": "Video Banner",
  "tag": "section",
  "class": "video__section",
  "settings": [
    {
      "type": "video",
      "label": "Video",
      "id": "video"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Falthschloss"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Jetzt einkaufen"
    },
    {
      "type": "url",
      "id": "url_link",
      "label": "URL Link"
    }
  ],
  "presets": [
    {
      "name": "Video Banner"
    }
  ]
}
{% endschema %}
